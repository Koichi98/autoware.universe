<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <!-- This file is self-contained and can be included in any node_container launch file -->
  <!--
    Configuration:
    - Checks ENABLE_AGNOCAST environment variable (set to "1" to enable)
    - Uses default heaphook path: /opt/ros/humble/lib/libagnocast_heaphook.so
  -->

  <!-- Check ENABLE_AGNOCAST environment variable -->
  <let name="agnocast_heaphook_path" value="/opt/ros/humble/lib/libagnocast_heaphook.so"/>
  <let name="use_agnocast_flag" value="$(env ENABLE_AGNOCAST 0)"/>

  <!-- Configure LD_PRELOAD based on ENABLE_AGNOCAST flag -->
  <let name="ld_preload_value" value="$(var agnocast_heaphook_path):$(env LD_PRELOAD '')" if="$(eval &quot;'$(var use_agnocast_flag)' == '1'&quot;)"/>
  <let name="ld_preload_value" value="$(env LD_PRELOAD '')" unless="$(eval &quot;'$(var use_agnocast_flag)' == '1'&quot;)"/>
</launch>
